<!DOCTYPE html>
<!--
    Miniport by HTML5 UP
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Peter Bouda - Working on Libre AI Projects</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="" />
    <meta
      name="keywords"
      content="AI, LLM, Natural Language Processing, Python, Software Development, Consultant"
    />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="theme-color" content="#ffffff" />

    <!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
    <script src="/theme/js/jquery.min.js"></script>
    <script src="/theme/js/jquery.scrolly.min.js"></script>
    <script src="/theme/js/skel.min.js"></script>
    <script src="/theme/js/init.js"></script>
    <link
      href="http://www.peterbouda.eu/feeds/all.atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Peter Bouda Atom Feed"
    />
     <link
      href="http://www.peterbouda.eu/feeds/all.rss"
      type="application/rss+xml"
      rel="alternate"
      title="Peter Bouda RSS Feed"
    />

    <link rel="stylesheet" href="/theme/css/pygment.css" />

    <noscript>
      <link rel="stylesheet" href="/theme/css/skel.css" />
      <link rel="stylesheet" href="/theme/css/style.css" />
      <link rel="stylesheet" href="/theme/css/style-desktop.css" />
    </noscript>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Person",
        "name": "Peter Bouda",
        "url": "https://www.peterbouda.eu",
        "jobTitle": "Working on Libre AI Projects",
        "alumniOf": "LMU Munich",
        "gender": "male",
        "image": "https://www.peterbouda.eu/theme/images/pic00.jpg",
        "sameAs": ["https://github.com/pbouda"]
      }
    </script>

    <!--[if lte IE 8
      ]><link rel="stylesheet" href="/theme/css/ie/v8.css"
    /><![endif]-->
    <!--[if lte IE 9
      ]><link rel="stylesheet" href="/theme/css/ie/v9.css"
    /><![endif]-->
  </head>
  <body>
		<!-- Nav -->
			<nav id="nav">
				<ul class="container">
					<li><a href="/#top">Home</a></li>
					<!--<li><a href="/#work">Work</a></li>-->
					<li><a href="/#portfolio">Portfolio</a></li>
					<li><a href="/#feed">Blog</a></li>
					<li><a href="/#contact">Contact</a></li>
				</ul>
			</nav> <section id="content" class="body">
  <article class="h-entry">
    <header>
      <h1 class="entry-title e-title">
        <a
          class="p-name u-url"
          href="http://www.peterbouda.eu/creating-a-dictionary-excel-to-toolbox-conversion.html"
          rel="bookmark"
          title="Permalink to Creating a dictionary: Excel to Toolbox conversion"
          >Creating a dictionary: Excel to Toolbox&nbsp;conversion</a
        >
      </h1>
    </header>

    <div class="entry-content e-content container">
      <div class="row">
        <div class="8u">
 <footer class="post-info">
    <p>
        Published by <a href="http://www.peterbouda.eu" class="p-author">Peter Bouda</a> at <b><time class="dt-published" datetime="2013-08-29 11:18:00+01:00">Thu 29 August 2013</time></b>
        in <b><a class="p-category" href="/category/language.html">Language</a></b>.
    </p>
    

        
</footer><!-- /.post-info -->          <p>In our current dictionary project &#8220;Bilingual Dictionary Piação-Portuguese&#8221; we
decided to use Microsoft Excel to edit the dictionary data. This choice had
some pragmatic reasons, like that most people/linguists can easily work with a
stylesheet, even if they don&#8217;t know about all the features of Excel, and that
Excel allows to export data in a structured way (as &#8220;comma separated values&#8221; in
a &#8220;<span class="caps">CSV</span> file&#8221;). Still, as the <a href="http://www-01.sil.org/computing/toolbox/">Toolbox</a>
dictionary generator is state-of-the-art in language documentation, we needed a
way to convert the Excel data to a Toolbox file. We did some first tests with
a simple Python script and everything worked out well until now, so here is a
short description of our&nbsp;workflow.</p>
<p>We created an empty Toolbox project that will give you a list of standard fields
like <code>Lexeme</code>, <code>Sound file</code>, etc. We added two or three example sentences,
customized the fields, and generated a first dictionary to see how the output
will look in the end and to get an example data file that we could use as a
template for the Excel data. The data file will be saved in the project folder
somewhere, in our case it was in
<code>Toolbox Project\DictionaryFactoryPackage\Dictionary.txt</code>. You can open the
file in a simple text editor to see the content. In our case, an entry looked
like&nbsp;this:</p>
<div class="highlight"><pre><span></span><code>\lx à bia
\sf
\pc
\ph aβiɐ
\se
\ps adv.
\un
\dn rápido, depressa
\sn
\rn rápido
\va
\et antropónimo Bia
\ec referência metonímica à alcunha de
um homem para designar uma
característica que lhe era peculiar
\wh da alcunha de um senhor (Bia) que
achava que tudo se podia resolver
rapidamente, mesmo que sem
qualidade. Doc. em CAORG 2004
\pce
\xv A covana colou do parreiral à bia e
a resmar.
\sfx
\ff
\xn &quot;&quot;A mulher saiu de casa depressa e a
falar sozinha.&quot;
\rf Ferreira 2000-2011. 
\nt
\cf
\dt 19
</code></pre></div>

<p>For most of the Toolbox fields we defined a column in Excel, with a custom name
so that our editors where able to understand the column&#8217;s content from the name
in Excel. With the column names and the field names in Toolbox we created the
following template in&nbsp;Python:</p>
<div class="highlight"><pre><span></span><code><span class="n">TEMPLATE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\\</span><span class="s2">lx </span><span class="si">{Lexema}</span>
<span class="se">\\</span><span class="s2">sf </span>
<span class="se">\\</span><span class="s2">pc </span>
<span class="se">\\</span><span class="s2">ph {Transcrição Fonética}</span>
<span class="se">\\</span><span class="s2">se</span>
<span class="se">\\</span><span class="s2">ps {Classe de Palavras}</span>
<span class="se">\\</span><span class="s2">un</span>
<span class="se">\\</span><span class="s2">dn </span><span class="si">{Significado}</span>
<span class="se">\\</span><span class="s2">sn</span>
<span class="se">\\</span><span class="s2">rn </span>
<span class="se">\\</span><span class="s2">va</span>
<span class="se">\\</span><span class="s2">et </span><span class="si">{Etimologia}</span>
<span class="se">\\</span><span class="s2">ec {Comentário de etimologia}</span>
<span class="se">\\</span><span class="s2">wh {Historia da Palavra}</span>
<span class="se">\\</span><span class="s2">pce</span>
<span class="se">\\</span><span class="s2">xv </span><span class="si">{Exemplos}</span>
<span class="se">\\</span><span class="s2">sfx</span>
<span class="se">\\</span><span class="s2">ff</span>
<span class="se">\\</span><span class="s2">xn {Exemplos PT}</span>
<span class="se">\\</span><span class="s2">rf {Fonte dos exemplos}</span>
<span class="se">\\</span><span class="s2">nt</span>
<span class="se">\\</span><span class="s2">cf</span>
<span class="se">\\</span><span class="s2">dt 31.07.2013</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

<p>The Excel column names are in the curely brackets, so that we can use Python&#8217;s
<code>format()</code> method to fill in the content. For the <span class="caps">CSV</span> file we had to export the
Excel data in LibreOffice Calc, as Excel does not support <span class="caps">UTF</span>-8 export (shame
on you, Microsoft!). We exported a single <span class="caps">CSV</span> file for each sheet in Calc,
so that we had a list of <span class="caps">CSV</span> files. With the template above and this collection
of <span class="caps">CSV</span> files it was easy to create a new <code>Dictionary.txt</code> for&nbsp;Toolbox:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;Dictionary.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tbfile</span><span class="p">:</span>
    <span class="n">tbfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;\_sh v3.0  231  MDF 4.0</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;Dictionary_database_NEW_*.csv&quot;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">minderico</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s1">&#39;excel&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">minderico</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">header</span> <span class="o">=</span> <span class="n">row</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header</span><span class="p">):</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tbfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">TEMPLATE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                        <span class="k">break</span>
</code></pre></div>

<p>The code even catches the error when a column name is wrong in the Excel sheet.
This will output a file <code>Dictionary.txt</code> that you can copy to your Toolbox
project folder to overwrite the original <code>Dictionary.txt</code>. With this we were
able to generate the whole dictionary in&nbsp;Toolbox.</p>
          <div id="comments">
			<script src="https://utteranc.es/client.js"
					repo="pbouda/peterbouda.eu"
					issue-term="pathname"
					label="Comment"
					theme="github-light"
					crossorigin="anonymous"
					async>
			</script>
          </div>
        </div>
        <!-- /.entry-content -->

        <div class="4u">
          <article class="box style2">
            <div>
              <img
                style="border-radius:50%; width:80%;"
                src="theme/images/pic00.jpg"
                alt=""
              />
            </div>
            <h3>About me</h3>
            <p>
              My name is Peter Bouda and I am a software developer with more than 20 years of
              professional experience in application development. I help
              you to bring your application to market as quickly as possible.
            </p>
            <!-- <p>
              Join our <a href="http://www.ng-lisbon.com/#trainings">next Angular training</a>
              in Lisbon, October 2-4.
            </p> -->
            <p>
              <a href="/#top">Read about my work</a><br />
              or<br />
              <a href="/#contact">Contact me</a>
            </p>
          </article>
        </div>
      </div>
      <!-- end row -->
    </div>
    <!-- end container -->
  </article>
</section>

 <!-- Contact -->
<div class="wrapper style4" id="contact">
  <article class="container 75%">
    <div class="row">
      <div class="12u">
        <h2>Send me a message and I will get back to you.</h2>
        <ul class="social">
          <li>
            <a href="mailto:pbouda@outlook.com" class="icon fa-envelope-o"
              ><span class="label">Mail</span></a
            >
          </li>
          <li>
            <a href="https://github.com/pbouda" class="icon fa-github"
              ><span class="label">Github</span></a
            >
          </li>
        </ul>
        <br />
        <h2>RSS Feed</h2>
        <ul class="social">
          <li>
            <a href="http://www.peterbouda.eu/feeds/all.rss" class="icon fa-rss"
              ><span class="label">RSS</span></a
            >
          </li>
        </ul>
        <hr />
      </div>
    </div>

    <footer>
      <ul id="copyright">
        <li>&copy; Peter Bouda. All rights reserved.</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
      </ul>
      <div>+351 917403181</div>
    </footer>
  </article>
</div>  </body>
</html>